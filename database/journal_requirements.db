-- journal_requirements.db - Comprehensive database for all publication requirements

-- Main publications table
CREATE TABLE publications (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    type TEXT NOT NULL, -- 'journal', 'conference', 'thesis', 'preprint', 'custom'
    category TEXT, -- 'international', 'subject_specific', 'computer_science', 'medicine', 'academic'
    language TEXT NOT NULL,
    citation_style TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Word limits for each publication
CREATE TABLE word_limits (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    publication_id INTEGER NOT NULL,
    abstract INTEGER,
    main_text INTEGER,
    methods INTEGER,
    total INTEGER,
    significance INTEGER,
    summary INTEGER,
    keywords INTEGER,
    brief_report INTEGER,
    short_paper INTEGER,
    chapter_limit INTEGER, -- For thesis
    FOREIGN KEY (publication_id) REFERENCES publications(id)
);

-- Structure requirements
CREATE TABLE structure_requirements (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    publication_id INTEGER NOT NULL,
    title_max_characters INTEGER,
    title_max_words INTEGER,
    title_notes TEXT,
    abstract_max_words INTEGER,
    abstract_structure TEXT,
    abstract_notes TEXT,
    sections TEXT, -- JSON array of required sections
    FOREIGN KEY (publication_id) REFERENCES publications(id)
);

-- Formatting rules
CREATE TABLE formatting_rules (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    publication_id INTEGER NOT NULL,
    font TEXT,
    spacing TEXT,
    margins TEXT,
    figures TEXT,
    line_numbers BOOLEAN DEFAULT FALSE,
    references TEXT,
    equations TEXT,
    physics_notation TEXT,
    protein_names TEXT,
    FOREIGN KEY (publication_id) REFERENCES publications(id)
);

-- Style guidelines
CREATE TABLE style_guidelines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    publication_id INTEGER NOT NULL,
    methods_tense TEXT,
    results_tense TEXT,
    established_facts_tense TEXT,
    voice TEXT,
    person TEXT,
    spelling TEXT,
    numbers TEXT,
    emphasis TEXT,
    statistics TEXT,
    clinical_trials TEXT,
    accessibility TEXT,
    human_subjects TEXT,
    datasets TEXT,
    reproducibility TEXT,
    ethics TEXT,
    clinical TEXT,
    FOREIGN KEY (publication_id) REFERENCES publications(id)
);

-- Special requirements
CREATE TABLE special_requirements (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    publication_id INTEGER NOT NULL,
    requirement TEXT NOT NULL,
    description TEXT,
    FOREIGN KEY (publication_id) REFERENCES publications(id)
);

-- Language variants
CREATE TABLE language_variants (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    variant_name TEXT NOT NULL,
    color TEXT,
    realize TEXT,
    center TEXT,
    analyze TEXT,
    organization TEXT,
    quotations TEXT,
    oxford_comma TEXT,
    notes TEXT
);

-- Citation styles
CREATE TABLE citation_styles (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    style_name TEXT NOT NULL,
    type TEXT, -- 'numbered', 'author-date', 'author-page'
    example TEXT,
    notes TEXT
);

-- Regional focuses
CREATE TABLE regional_focuses (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    region_name TEXT NOT NULL,
    target_audience TEXT,
    language_preference TEXT,
    cultural_considerations TEXT
);

-- Custom user requirements
CREATE TABLE custom_requirements (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    session_id TEXT,
    journal_name TEXT,
    language_variant TEXT,
    regional_focus TEXT,
    abstract_word_limit INTEGER,
    total_word_limit INTEGER,
    citation_style TEXT,
    section_requirements TEXT,
    custom_text TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Insert Publications Data
INSERT INTO publications (name, type, category, language, citation_style) VALUES

-- Journals
('Nature', 'journal', 'international', 'British English', 'Nature format'),
('Science', 'journal', 'international', 'American English', 'Science format'),
('Cell', 'journal', 'international', 'American English', 'Cell format'),
('The Lancet', 'journal', 'international', 'British English', 'Vancouver'),
('New England Journal of Medicine', 'journal', 'international', 'American English', 'NEJM format'),
('Journal of Biological Chemistry', 'journal', 'subject_specific', 'American English', 'JBC format'),
('IEEE Transactions', 'journal', 'subject_specific', 'American English', 'IEEE format'),
('Physical Review Letters', 'journal', 'subject_specific', 'American English', 'Physical Review format'),

-- Conferences
('ACM CHI', 'conference', 'computer_science', 'American English', 'ACM format'),
('IEEE ICCV', 'conference', 'computer_science', 'American English', 'IEEE format'),
('NeurIPS', 'conference', 'computer_science', 'American English', 'NeurIPS format'),
('American Medical Association', 'conference', 'medicine', 'American English', 'AMA format'),

-- Thesis (from HTML)
('Master''s Thesis', 'thesis', 'academic', 'Institution dependent', 'Institution specific'),
('PhD Thesis', 'thesis', 'academic', 'Institution dependent', 'Institution specific'),
('Institution-Specific', 'thesis', 'academic', 'Institution dependent', 'Institution specific'),

-- Preprints
('arXiv', 'preprint', 'general', 'International English', 'flexible'),
('bioRxiv', 'preprint', 'biological', 'International English', 'flexible');

-- Insert Word Limits
INSERT INTO word_limits (publication_id, abstract, main_text, methods, total, significance, summary, keywords, brief_report, short_paper, chapter_limit) VALUES

-- Journals
(1, 150, 3000, 1500, 4500, NULL, NULL, NULL, NULL, NULL, NULL), -- Nature
(2, 125, 2500, NULL, 3500, NULL, NULL, NULL, NULL, NULL, NULL), -- Science
(3, 150, 4000, NULL, NULL, 120, NULL, NULL, NULL, NULL, NULL), -- Cell
(4, 300, 4500, NULL, NULL, NULL, 100, NULL, NULL, NULL, NULL), -- The Lancet
(5, 250, 2700, NULL, NULL, NULL, NULL, NULL, 1200, NULL, NULL), -- NEJM
(6, 250, 6000, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), -- JBC
(7, 200, 8000, NULL, NULL, NULL, NULL, 5, NULL, NULL, NULL), -- IEEE
(8, 600, 3750, NULL, 4500, NULL, NULL, NULL, NULL, NULL, NULL), -- PRL

-- Conferences
(9, 150, 5000, NULL, NULL, NULL, NULL, NULL, NULL, 2500, NULL), -- ACM CHI
(10, 200, 8000, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), -- IEEE ICCV
(11, 250, 9000, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), -- NeurIPS
(12, 300, 2500, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), -- AMA

-- Thesis (from HTML requirements)
(13, 350, 15000, NULL, 20000, NULL, NULL, NULL, NULL, NULL, 6), -- Master's
(14, 500, 80000, NULL, 100000, NULL, NULL, NULL, NULL, NULL, 10), -- PhD
(15, 400, 50000, NULL, 60000, NULL, NULL, NULL, NULL, NULL, 8), -- Institution-Specific

-- Preprints
(16, 1920, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), -- arXiv
(17, 300, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL); -- bioRxiv

-- Insert Structure Requirements
INSERT INTO structure_requirements (publication_id, title_max_characters, title_max_words, title_notes, abstract_max_words, abstract_structure, abstract_notes, sections) VALUES

-- Nature
(1, 90, NULL, 'Should be accessible to broad readership', 150, 'Background, Methods, Results, Conclusions', 'No references in abstract', '["Introduction", "Results", "Discussion", "Methods", "Acknowledgements", "References"]'),

-- Science
(2, NULL, 15, 'Concise and impactful', 125, 'One paragraph, structured summary', NULL, '["One-sentence summary", "Abstract", "Main text", "Materials and Methods", "References and Notes"]'),

-- Cell
(3, NULL, NULL, NULL, 150, NULL, NULL, '["Title", "Summary", "Significance", "Introduction", "Results", "Discussion", "Experimental Procedures", "References"]'),

-- The Lancet
(4, NULL, NULL, NULL, 300, 'Background, Methods, Findings, Interpretation', NULL, '["Summary", "Introduction", "Methods", "Results", "Discussion", "References"]'),

-- NEJM
(5, NULL, NULL, NULL, 250, 'Background, Methods, Results, Conclusions', NULL, '["Abstract", "Introduction", "Methods", "Results", "Discussion", "References"]'),

-- Master's Thesis (from HTML)
(13, NULL, NULL, 'Clear and descriptive', 350, 'Background, Objectives, Methods, Results, Conclusions', 'Comprehensive summary', '["Title Page", "Abstract", "Table of Contents", "Introduction", "Literature Review", "Methodology", "Results", "Discussion", "Conclusion", "References", "Appendices"]'),

-- PhD Thesis (from HTML)
(14, NULL, NULL, 'Original contribution to knowledge', 500, 'Background, Objectives, Methods, Results, Conclusions, Significance', 'Detailed summary of contribution', '["Title Page", "Abstract", "Table of Contents", "Introduction", "Literature Review", "Methodology", "Results", "Discussion", "Conclusion", "References", "Appendices"]'),

-- Institution-Specific (from HTML)
(15, NULL, NULL, 'Follow institution guidelines', 400, 'As per institution requirements', 'Check specific formatting guide', '["As per institution requirements"]');

-- Insert Language Variants
INSERT INTO language_variants (variant_name, color, realize, center, analyze, organization, quotations, oxford_comma, notes) VALUES
('American English', 'color', 'realize', 'center', 'analyze', 'organization', '"inside punctuation."', 'required', NULL),
('British English', 'colour', 'realise', 'centre', 'analyse', 'organisation', '"outside punctuation".', 'optional', NULL),
('International English', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'Mix of conventions, generally more flexible');

-- Insert Citation Styles
INSERT INTO citation_styles (style_name, type, example, notes) VALUES
('Nature format', 'numbered', 'Smith, J. Nature 123, 456-789 (2023).', 'Abbreviated journal names, no issue numbers'),
('Science format', 'numbered', 'J. Smith, Science 123, 456 (2023).', 'Very abbreviated, page numbers without dash'),
('APA', 'author-date', 'Smith, J. (2023). Title. Journal Name, 123(4), 456-789.', 'Full journal names'),
('IEEE format', 'numbered', '[1] J. Smith, "Title," Journal Name, vol. 123, no. 4, pp. 456-789, 2023.', 'Quoted article titles'),
('MLA', 'author-page', 'Smith, John. "Title." Journal Name, vol. 123, no. 4, 2023, pp. 456-789.', 'Full names, quoted titles'),
('Vancouver', 'numbered', 'Smith J. Title. Journal Name. 2023;123(4):456-89.', 'Medical journals standard'),
('Institution specific', 'varies', 'As per institution guidelines', 'Check specific thesis formatting requirements');

-- Insert Regional Focuses
INSERT INTO regional_focuses (region_name, target_audience, language_preference, cultural_considerations) VALUES
('International', 'global research community', 'clear, accessible English', 'avoid region-specific references'),
('USA/Canada', 'North American research community', 'American English', 'US regulations and standards referenced'),
('UK/Europe', 'European research community', 'British English', 'EU regulations and standards'),
('Asia-Pacific', 'Asian research community', 'International English', 'regional research priorities');

-- Insert Special Requirements
INSERT INTO special_requirements (publication_id, requirement, description) VALUES

-- Nature
(1, 'Significance statement', 'Required for all submissions'),
(1, 'Data availability statement', 'Must specify how data can be accessed'),
(1, 'Author contributions section', 'Detail each author''s contribution'),
(1, 'Competing interests declaration', 'Financial and non-financial conflicts'),

-- Science
(2, 'One-sentence summary', 'Maximum 125 characters'),
(2, 'Data and materials availability', 'Specify access to data and materials'),
(2, 'Supplementary materials section', 'Additional supporting information'),

-- Cell
(3, 'Significance statement', '120 words maximum'),
(3, 'Graphical abstract required', 'Visual summary of key findings'),
(3, 'eTOC blurb', '40-50 words for table of contents'),

-- Master's Thesis (from HTML requirements)
(13, 'Ethics approval', 'If human subjects or animals involved'),
(13, 'Institutional formatting', 'Follow department/university guidelines'),
(13, 'Thesis defense', 'Oral defense typically required'),

-- PhD Thesis (from HTML requirements)
(14, 'Original contribution', 'Demonstrate significant original research'),
(14, 'Ethics approval', 'Comprehensive ethics review if applicable'),
(14, 'Publication ready chapters', 'Chapters should be publication quality'),

-- Institution-Specific (from HTML requirements)
(15, 'Institution guidelines', 'Follow specific university/college requirements'),
(15, 'Format approval', 'May require format pre-approval'),
(15, 'Binding requirements', 'Physical thesis binding specifications');

-- Create indexes for better performance
CREATE INDEX idx_publications_type ON publications(type);
CREATE INDEX idx_publications_category ON publications(category);
CREATE INDEX idx_word_limits_pub ON word_limits(publication_id);
CREATE INDEX idx_structure_req_pub ON structure_requirements(publication_id);
CREATE INDEX idx_formatting_rules_pub ON formatting_rules(publication_id);
CREATE INDEX idx_style_guidelines_pub ON style_guidelines(publication_id);
CREATE INDEX idx_special_req_pub ON special_requirements(publication_id);
CREATE INDEX idx_custom_req_user ON custom_requirements(user_id);
CREATE INDEX idx_custom_req_session ON custom_requirements(session_id);
